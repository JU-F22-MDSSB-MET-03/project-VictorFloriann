---
title: "Global climate heading in a Wrong Direction: Mechanism behind the occurrence of climatic change and analysis of Children Climate risk index"
author: "Victor & Floriann"
format: 
  html:
    toc: true                   # This creates the table of context menu
    toc-depth: 2                # Increase if you want to have subsections in the table of context menu
    number-sections: true
    code-fold: true
    code-tools: true
bibliography: references.bib
---

```{r}
#| label: packages
#| message: false

# These are the packages used in the report
# Import required package
library(tidyverse)
library(dplyr)
library(ggplot2)
library(plotly)
library("RColorBrewer")
library(skimr)
library("zoo")
library(plotly) #world map
library(ggridges)
library(forcats)
options(warn=-1)
#library(corrplot)
library(reshape2)
library(gganimate)
library("gridExtra")
library("ggpubr")
#install.packages("ggpubr")
library(gganimate)
require(plyr)
library(rnoaa)
library(rgdal)
library(ggthemes)
library(lubridate)
```

This slide deck presents the main insights:

```{=html}
<iframe class="slide-deck" style="border:1px solid lightgray;" width="100%" height="500" src="presentation.html"></iframe>
```

[Presentation in standalone browser tab.](presentation.html){.internal target="_blank"}

Detailed project report

## Executive Summary

## Introduction
<p align='justify'>
*Climate Science* has become an intimidating subject matter which is drawing attention in recent days.
It is evident that human activities are driving the global warming since mid-20th century. The industrial activities that our modern civilization has taken up leads to raised atmospheric carbon dioxide levels.
</p>
<p align='justify'>
UN Climate change states that the past seven years were the warmest on record. Countries that host billions of people and are responsible for up to 70% of human-caused emissions are predicted to get affected the most. This leads to increasing socio-economic impacts. Consequently, making populations vulnerable to extreme weather in different parts of the world. 
</p>
<p align='justify'>
Climate impacts heading into uncharted territory of destruction by increasingly devastating and leading to many natural calamities. This report will unveil the most inquisitive questions arising which causes and mechanism in global warming along with the human activities leading to natural changes in the environment.  As a consequence how humankind is affected, especially children. This study will address the following questions,
</p>
<p align='justify'>
1. What is the mechanism behind the occurrence of climatic change?
	- Emissions of greenhouse gases over a period of time due to industrial revolution.
	- Descriptive statistics on factor facilitating Climate change.
2. Study the trend in natural disaster due to global warming.
3. Analysis on children vulnerability to climatic change with respective to Children Climate risk index(CCRI) data.
</p>

## Methodology and resulting outcomes

**Data Source**
<br>
The Key metrics which contributes to the global climate change is maintained by Our World in Data. 
Data source will be accessed by from Github API with *R* language. There are 3 datasets which will be used for this study, namely
<br>
1. Emission levels data and temperature<br>
	  --Link : *<https://github.com/owid/co2-data>* <br>
	  Link : Kaggle
	  Link : *<>*
2. Natural disaster data<br>
	  Link : *<https://github.com/owid/owid-datasets/tree/master/datasets/Natural%20disasters%20(EMDAT%20–%20decadal)>* <br>
3. Global temperature data<br>
    Link : *<https://data.giss.nasa.gov/gistemp/ https://data.giss.nasa.gov/gistemp/tabledata_v4/T_AIRS/GLB.Ts+dSST.csv>*
4. Children’s Climate and Environment Risk Index<br>
    Link : *<https://sdmx.data.unicef.org/webservice/data.html>*

Set directory and load data
```{r}
#Code to extract data:
climate_change <- read.csv(file = "data/climate_change.csv",TRUE, sep = ",", stringsAsFactors = FALSE)
cceri_data <- read.csv(file = "data/CC_ERI.csv",TRUE, sep = ",", stringsAsFactors = FALSE)
natural_disaster_data <- read.csv(file = "data/natural_disaster.csv",TRUE, sep = ",", stringsAsFactors = FALSE)
continent <- read.csv(file = "data/Continents.csv",TRUE, sep = ",", stringsAsFactors = FALSE)
population <- read.csv(file = "data/world_population.csv",TRUE, sep = ",", stringsAsFactors = FALSE)
```

Statistical analysis
```{r}
#Statistical description
dim(climate_change)
dim(cceri_data)
dim(natural_disaster_data)
```

```{r}
##Summary statistics with SKIM function
#skim(climate_change)
#skim(cceri_data)
#skim(natural_disaster_data)
```

```{r}
##Checking NA values in the dataset
apply(is.na(climate_change),2, sum)
apply(is.na(cceri_data),2, sum)
#apply(is.na(natural_disaster_data),2, sum)
```

## Initial Visualisations

### Global surface temperature

```{r message=FALSE}
#### Visual 1: adding Year-Month variable as year_date
climate_change$year <- as.yearmon(paste(climate_change$Year, climate_change$Month), "%Y %m")

# plotting Temperature-Year 
ggplot(climate_change, aes(year, Temp)) + 
  geom_line(aes(color = "actual temperature")) +
  geom_smooth(aes(se=FALSE, color = "Avg temp")) +
  labs(title = "Global Temperature is rising",
       subtitle = "Global temperature rise from 1985 to 2022 (°C)",
       y = "Global Earth Temperature",
       color = "Temperature",
       caption = "Annual estimates of mean surface temperature change measured in Degree Celsius for World.",) +
  scale_colour_manual(values = c("orange", "blue"),
                      labels = c("Actual temperature", "Average temperature")) +
  theme_classic() +
  scale_y_continuous(limits = c(-.5,1.5)) +
  scale_x_continuous(limits = c(1985,2022)) +
  theme(plot.title = element_text(face = "bold",
                                  margin = margin(10, 0, 10, 0),
                                  size = 14)) +
  theme(panel.grid.minor = element_blank()) 
```

<p align='justify'>
Air temperatures on Earth have been rising since the Industrial Revolution. According to an ongoing temperature analysis led by scientists at NASA’s Goddard Institute for Space Studies (GISS), the average global temperature on Earth has increased by at least 1.1° Celsius (1.9° Fahrenheit) since 1880. A one-degree global change is significant because it takes a vast amount of heat to warm all of the oceans, the atmosphere, and the land masses by that much. In the past, a one- to two-degree drop was all it took to plunge the Earth into the Little Ice Age. A five-degree drop was enough to bury a large part of North America under a towering mass of ice 20,000 years ago.
</p>

### Temperature density

```{r fig.height = 6, message=FALSE}
#Visual 2: Temperature density

# adding right and left hand sided labels
climate_change <- climate_change %>%
  mutate(label_rt = if_else(Month == 12 & Year%%2 == 0, 
                            as.character(Year), NA_character_)) %>%
  mutate(label_lt = if_else(Month == 1 & Year%%2 != 0, 
                            as.character(Year), NA_character_))

ggplot(climate_change, aes(x = Temp, y = as.factor(Year))) + 
  geom_density_ridges_gradient(aes(fill = ..x..), 
                               scale = 3, size = 0.3, alpha = 0.5) +
  geom_vline(xintercept = 0.5, alpha = 0.5, color = "red", linetype = "dotted")+
  scale_fill_gradientn(colours = c("#87CEFA", "#FFFFE0", "#FF0000"),
                       name = "Temperature (°C)") +
  labs(title = 'Shifting Distribution of Earth Temperature',
       subtitle = "Temperature Difference in degrees Celsius from the year 1983 to 2022",
       caption = "NASA: https://svs.gsfc.nasa.gov/4891",) + 
  theme(plot.title = element_text(face = "bold",
                                  margin = margin(10, 0, 10, 0),
                                  size = 14)) +
  theme(legend.position = c(0.8,0.2)) +
  xlab("Temperature") + 
  ylab("Year") + 
  theme_classic()

```

<p align='justify'>
This visualization shows how the distribution of land temperature anomalies has varied over time. As the planet has warmed, we see the peak of the distribution shifting to the right. The distribution of temperatures broadens as well. This broadening is most likely due to differential regional warming rather than increased temperature variability at any given location.
</p>

```{r message=FALSE}
p <- ggplot(climate_change, aes(x = Year, y = Temp, color = Month, group = Month)) +
    geom_path() +
    geom_point() +
    facet_wrap(~ Month) +
    theme(legend.position = 'none') +
    labs(title = 'Temperature Variation, Year: {frame_along}') +
    transition_reveal(along = Year) +
    ease_aes('linear')
animate(p, 100, 10)
```

```{r message=FALSE}
north_sea <- sea_ice(year = 2017:2022, month = 'May', pole = "N")
names(north_sea) <- seq(2017, 2022, 1)
df_north <- ldply(north_sea)

ggplot(df_north, aes(long, lat, group = group)) + 
  geom_polygon(fill = "steelblue") + 
  ggtitle("Changes in Sea Ice Level for North pole") + 
  theme_ice() + 
  facet_wrap(~.id)

```

```{r message=FALSE}
#### South Pole Sea Ice Level

south_sea <- sea_ice(year = 2017:2022, month = 'May', pole = "S")
names(south_sea) <- seq(2017, 2022, 1)
df_south <- ldply(south_sea)

# Plot data
ggplot(df_south, aes(long, lat, group = group)) + 
  geom_polygon(fill = "steelblue") + 
  ggtitle("Changes in Sea Ice Level for South pole") + 
  theme_ice() + 
  facet_wrap(~.id)

```

```{r message=FALSE}

#library(ggplot2)
#remove.packages("ggthemes")
north_data <- read.csv(url("https://www.ncdc.noaa.gov/snow-and-ice/extent/sea-ice/N/8.csv"),skip=3)
south_data = read.csv(url("https://www.ncdc.noaa.gov/snow-and-ice/extent/sea-ice/S/8.csv"),skip=3)

north_data$'North Sea Ice Level' = north_data$Anomaly
south_data$'South Sea Ice Level' = south_data$Anomaly

poles_data = merge(north_data[,-c(2,3)], south_data[,-c(2,3)], by="Date")
#head(poles_data)
poles_Melted <- reshape2::melt(poles_data, id.var='Date')
#head(poles_Melted)

ggplot(poles_Melted, aes(x=Date, y=value, col=variable)) + 
  geom_line(linetype="solid", size=1) +
  #scale_fill_discrete(name = “Poles”, labels = c(“North Sea Ice Level”, “South Sea Ice Level”)) +
  xlab("Year") +
  ylab("Change is Sea Ice Level") +
  ggtitle("Comparing Changes in Sea Ice Level") +
  theme_classic()
```
### MEI 

```{r message=FALSE}
climate_change <- climate_change %>% mutate(year_month = ymd(paste(climate_change$Year, climate_change$Month, truncated = 1))) 

climate_change %>%
  arrange(year_month) %>%
  ggplot() + 
  geom_line(aes(year_month, MEI, color = MEI), size = 1) +
  scale_color_gradient2(low = 'blue', high = 'red') + 
  labs(title = "Multivariate El Nino Southern Oscillation index by Year", 
       caption = "Source: ESRL/NOAA Physical Sciences Division") + 
  xlab("Year") +
  ylab("MEI") + 
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_minimal()
```

### Carbon dioxide

```{r message=FALSE}
climate_change_chart <- ggplot(climate_change, aes(x = Year, y = Temp, fill = CO2)) + 
  xlab("Year") +
  ylab("Temperature") +
  theme_minimal(base_size = 14)

barplot <- climate_change_chart +
  geom_bar( position = "dodge", stat = "identity",color= "white")
ggplotly(barplot)

```

```{r message=FALSE}
climate_change_ymd <- climate_change %>%
  mutate(year_month = ymd(paste(climate_change$Year, climate_change$Month, truncated = 1))) 

scat_plot1 <-  ggplot(climate_change_ymd, aes(year_month, CO2))+geom_line(colour="blueviolet")+geom_smooth(method = "lm")+ggtitle("Carbon Dioxide") + theme_minimal(base_size = 14)
scat_plot2<-  ggplot(climate_change_ymd, aes(year_month, N2O))+geom_line()+geom_smooth(method = "lm")+ggtitle("Nitrous Oxide") + theme_minimal(base_size = 14)
scat_plot3<-  ggplot(climate_change_ymd, aes(year_month, CH4))+geom_line(colour="springgreen4")+geom_smooth(method = "lm")+ggtitle("Methane") + theme_minimal(base_size = 14)
scat_plot4 <-  ggplot(climate_change_ymd, aes(year_month, MEI))+geom_line(colour="mediumorchid4")+ggtitle("MEI") + theme_minimal(base_size = 14)
grapgh_arrange<-ggarrange(scat_plot1, scat_plot2, scat_plot3, scat_plot4 + rremove("x.text"), 
          labels = c("A", "B", "C", "D"),
          ncol = 2, nrow = 2)
annotate_figure(grapgh_arrange,
                top = text_grob("Vartations of CO_2, N2O, CH4 and MEI by year", color = "red", face = "bold", size = 14)
)

```

```{r message=FALSE}
climate_change %>%
  arrange(year_month) %>%
  ggplot(aes(year_month, CO2)) + 
  geom_line() +
  geom_smooth(se = FALSE, linetype = "dotted", color = "red") +
  labs(title = "Carbon-dioxide by Year", 
       caption = "Source: ESRL/NOAA Global Monitoring Division") + 
  xlab("Year") +
  ylab("CO2 (ppmv)") + 
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_classic()
```
### Methane
```{r message=FALSE}
climate_change %>%
  arrange(year_month) %>%
  ggplot(aes(year_month, CH4)) + 
  geom_line() +
  geom_smooth(se=FALSE, linetype = "dotted", color = "red") +
  labs(title = "Methane by Year", 
       caption = "Source: ESRL/NOAA Global Monitoring Division") + 
  xlab("Year") +
  ylab("CH4 (ppmv)") + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  theme_classic()
```
### Nitrous Oxide
```{r message=FALSE}
climate_change %>%
  arrange(year_month) %>%
  ggplot() + 
  geom_line(aes(year_month, N2O)) +
  labs(title = "Nitrous Oxide by Year", 
       caption = "Source: ESRL/NOAA Global Monitoring Division") + 
  xlab("Year") +
  ylab("N2O (ppmv)") + 
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r message=FALSE}
library(gganimate)
ggplot(climate_change, aes(Year, Temp, size = CO2, colour = Month)) + geom_point(alpha = 0.2, show.legend = FALSE) +
  facet_wrap(~Month) +
  # Here comes the gganimate specific bits
  labs(title = 'Year: {frame_time}', x = 'Year', y = 'Temperature') +
  transition_time(Year) +
  ease_aes('linear')
```

```{r message=FALSE}
p <- ggplot(climate_change, aes(x = Year, y = Temp, color = Month, group = Month)) +
    geom_path() +
    geom_point() +
    facet_wrap(~ Month) +
    theme(legend.position = 'none') +
    labs(title = 'Temperature Variation, Year: {frame_along}') +
    transition_reveal(along = Year) +
    ease_aes('linear')
animate(p, 100, 10)
```

### Natural disaster - affected/death and injured

```{r message=FALSE}
##Pre-processing
#Selecting only required columns from Natural disaster data for further analysis and visualization
disaster_data <- natural_disaster_data %>% 
                  select(Entity,Year, affected_all_disasters, affected_temperature, affected_flood, affected_wildfire, 
                         deaths_all_disasters, deaths_temperature, deaths_flood, deaths_wildfire,
                         homeless_all_disasters, homeless_temperature, homeless_flood, homeless_wildfire,
                         injured_all_disasters, injured_temperature, injured_flood, injured_wildfire,
                         total_affected_all_disasters, total_affected_temperature, total_affected_flood, total_affected_wildfire,total_damages_pct_gdp_all_disasters, total_damages_pct_gdp_temperature, total_damages_pct_gdp_flood, total_damages_pct_gdp_wildfire) %>%
                  group_by(Entity) %>% filter(Year == max(Year)) %>% # Take the most recent date per country
                  group_by() %>% #removing groupby
                  drop_na() 

#Selecting only continents from the dataset:
# Asia, Africa, North America, South America, Antarctica, Europe, and Australia.
#names (natural_disaster_data)
continent_data <- filter(disaster_data, 
                         Entity %in% c("Asia", "Africa", "North America", "South America", "Antarctica",
                                     "Europe", "Australia"))
```

<p align='justify'>
Observation: 
</p>

#### Natural disaster - Affected due to all disaster

```{r message=FALSE}
continent_data_new <- continent %>% 
              select(name,alpha.3,region,sub.region) %>%
              drop_na()

#Joining disaster data with continent data:
colnames(continent_data_new)[1] <- "Entity"
disaster_data_country <- left_join(disaster_data, continent_data_new, by = c('Entity'))
disaster_data_country <- disaster_data_country %>% 
                        #filter(disaster_data_country, (region %in% c("Asia", "Americas","Africa"))) %>% 
                        drop_na() 
#head(disaster_data_country,2)

#Joining population dataset to disaster data

#population <- population %>% select(CCA3, Entity,X2010.Population)
#colnames(population)[2] <- "Entity"
#disaster_data_country <- left_join(disaster_data_country, population, by = c('Entity'))
#disaster_data_country <- disaster_data_country %>% 
                        #drop_na() 
head(disaster_data_country,2)
```

```{r message=FALSE}
#all_infected <- aggregate(x = disaster_data_country$affected_all_disasters,                # Specify data column
 #         by = list(disaster_data_country$region),              # Specify group indicator
  #          FUN = mean) 
#continent_data$affected_all_disasters= 100*(continent_data$affected_all_disasters/sum(continent_data$affected_all_disasters))
```    

```{r message=FALSE}
#all_infected$score_percen= 100*(all_infected$x/sum(all_infected$x))
#all_infected
#disaster_data_country$affected_all_disasters = log(as.data.frame(disaster_data_country$affected_all_disasters))
#disaster_data_country$affected_all_disasters <- as.numeric(as.character(disaster_data_country$affected_all_disasters))
```

```{r message=FALSE}
#disaster_data_country_new <- disaster_data_country %>%
#                              drop_na() %>%
#                              mutate(all_affected = #(disaster_data_country$affected_all_disasters/disaster_data_country$X2010.Population)*100)
```

```{r message=FALSE}
#disaster_data_country_new$all_affected <- log(disaster_data_country_new$all_affected) 

#disaster_data_country_new$affected_all_disasters <- as.integer(disaster_data_country_new$population) 
#disaster_data_country_new$all_affected <- format(round(disaster_data_country_new$all_affected, 2), nsmall = 2) 
#disaster_data_country_new <- disaster_data_country_new %>%
                              #mutate(all_affected = (all_affected*100))
```

```{r message=FALSE}
#ggplot(disaster_data_country, aes(x=region, y=as.integer(affected_all_disasters))) + 
 # geom_bar(stat = "identity")

```

```{r message=FALSE}
#disaster_data_country_new <- disaster_data_country %>%
#                              drop_na() %>%
#                              mutate(all_affected = #(disaster_data_country$affected_all_disasters/disaster_data_country$X2010.Population)*100)
```

#### Natural disaster - affected_all_disasters

```{r message=FALSE}
# affected_all_disasters
continent_data$affected_all_disasters= 100*(continent_data$affected_all_disasters/sum(continent_data$affected_all_disasters))

ggplot(data=continent_data, aes(x=Entity, y=affected_all_disasters)) +
    geom_bar(colour="black", fill="#DD8888", width=.8, stat="identity",position=position_dodge()) +
    coord_flip() +
    xlab("C") + 
    ylab("percentage of People affected") +
    labs(title = 'People affected by climate change disasters',
         subtitle = "Disasters: drought, temperature, flood, fog, wildfire, glacial lake",
         caption = "Number of people is calculated in percentage",
       ) + 
    labs(x = "") +
    theme_classic()
    #guides(fill=FALSE)
```

```{r message=FALSE}
names(disaster_data_country)
```

```{r message=FALSE}
# Checking the top 5 countries having affected_temperature due to disaster:
disaster_data_country_asia <- filter(disaster_data_country, (region %in% c(
                                                              "Asia")))
sorted = sort(disaster_data_country_asia$affected_temperature,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top5 <- disaster_data_country_asia[sorted[1:10],]
top5 <- data.frame(Entity=disaster_data_country_asia$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top5$Entity <- as.character(top5$Entity) # make the country names as character
#To plot:
top5_data <- dplyr::inner_join(disaster_data_country_asia,top5,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top5_data$affected_temperature <- log (top5_data$affected_temperature)
p <- ggplot(top5_data, aes(x = reorder(Entity, +affected_temperature), y=affected_temperature, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

```{r message=FALSE}
# Checking the top 5 countries having affected_flood due to disaster:
disaster_data_country_asia <- filter(disaster_data_country, (region %in% c(
                                                              "Asia")))
sorted = sort(disaster_data_country_asia$affected_flood,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top5 <- disaster_data_country_asia[sorted[1:10],]
top5 <- data.frame(Entity=disaster_data_country_asia$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top5$Entity <- as.character(top5$Entity) # make the country names as character
#To plot:
top5_data <- dplyr::inner_join(disaster_data_country_asia,top5,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top5_data$affected_flood <- log (top5_data$affected_flood)
p <- ggplot(top5_data, aes(x = reorder(Entity, +affected_flood), y=affected_flood, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

#### Natural disaster - deaths_all_disasters

```{r message=FALSE}
# No legend, since the information is redundant
# Add y axis units - TBD
#continent_data$affected_temperature <- log(continent_data$affected_temperature) 

continent_data$deaths_all_disasters= 100*(continent_data$deaths_all_disasters/sum(continent_data$deaths_all_disasters))

ggplot(data=continent_data, aes(x=Entity, y=deaths_all_disasters)) +
    geom_bar(colour="black", fill="#DD8888", width=.8, stat="identity",position=position_dodge()) +
    coord_flip() +
    xlab("C") + 
    ylab("percentage of People died") +
    labs(title = 'People affected by climate change disasters',
         subtitle = "Disasters: drought, temperature, flood, fog, wildfire, glacial lake",
         caption = "Number of people is calculated in percentage",
       ) + 
    labs(x = "") +
    theme_classic()
    #guides(fill=FALSE)

```


```{r message=FALSE}
# Checking the top 5 countries having deaths_all_disasters due to disaster:
disaster_data_country_americas <- filter(disaster_data_country, (region %in% c(
                                                              "Americas")))
sorted = sort(disaster_data_country_americas$deaths_all_disasters,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top5 <- disaster_data_country_americas[sorted[1:10],]
top5 <- data.frame(Entity=disaster_data_country_americas$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top5$Entity <- as.character(top5$Entity) # make the country names as character
#To plot:
top5_data <- dplyr::inner_join(disaster_data_country_americas,top5,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top5_data$deaths_all_disasters <- log (top5_data$deaths_all_disasters)
p <- ggplot(top5_data, aes(x = reorder(Entity, +deaths_all_disasters), y=deaths_all_disasters, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

```{r message=FALSE}
# Checking the top 5 countries having deaths_wildfire due to disaster:
disaster_data_country_americas <- filter(disaster_data_country, (region %in% c(
                                                              "Americas")))
sorted = sort(disaster_data_country_americas$deaths_wildfire,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_americas[sorted[1:3],]
top10 <- data.frame(Entity=disaster_data_country_americas$Entity[sorted[1:3]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_americas,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$deaths_wildfire <- log (top10_data$deaths_wildfire)
p <- ggplot(top10_data, aes(x = reorder(Entity, +deaths_wildfire), y=deaths_wildfire, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```
```{r message=FALSE}
# Checking the top 5 countries having deaths_flood due to disaster:
disaster_data_country_americas <- filter(disaster_data_country, (region %in% c(
                                                              "Americas")))
sorted = sort(disaster_data_country_americas$deaths_flood,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_americas[sorted[1:10],]
top10 <- data.frame(Entity=disaster_data_country_americas$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_americas,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$deaths_flood <- log (top10_data$deaths_flood)
p <- ggplot(top10_data, aes(x = reorder(Entity, +deaths_flood), y=deaths_flood, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

#### Natural disaster - homeless_all_disasters

```{r message=FALSE}
# homeless_all_disasters

continent_data$homeless_all_disasters= 100*(continent_data$homeless_all_disasters/sum(continent_data$homeless_all_disasters))

ggplot(data=continent_data, aes(x=Entity, y=homeless_all_disasters)) +
    geom_bar(colour="black", fill="#DD8888", width=.8, stat="identity",position=position_dodge()) +
    coord_flip() +
    ylab("percentage of People homeless") +
    labs(title = 'People death due to climate change disasters',
         subtitle = "Disasters: drought, temperature, flood, fog, wildfire, glacial lake",
         caption = "Number of people homeless is calculated in perentage",
       ) + 
    labs(x = "") +
    theme_classic()
```

```{r message=FALSE}
# Checking the top 5 countries having deaths_flood due to disaster:
disaster_data_country_asia_homeless <- filter(disaster_data_country, (region %in% c(
                                                              "Asia")))
sorted = sort(disaster_data_country_asia_homeless$homeless_all_disasters,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_asia_homeless[sorted[1:10],]
top10 <- data.frame(Entity=disaster_data_country_asia_homeless$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_asia_homeless,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$homeless_all_disasters <- log (top10_data$homeless_all_disasters)
p <- ggplot(top10_data, aes(x = reorder(Entity, +homeless_all_disasters), y=homeless_all_disasters, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```


```{r message=FALSE}
# Checking the top 5 countries having homeless_temperature due to disaster:
disaster_data_country_asia_homeless <- filter(disaster_data_country, (region %in% c(
                                                              "Asia")))
sorted = sort(disaster_data_country_asia_homeless$homeless_temperature,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_asia_homeless[sorted[1:10],]
top10 <- data.frame(Entity=disaster_data_country_asia_homeless$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_asia_homeless,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$homeless_temperature <- log (top10_data$homeless_temperature)
p <- ggplot(top10_data, aes(x = reorder(Entity, +homeless_temperature), y=homeless_temperature, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```
```{r message=FALSE}
# Checking the top 5 countries having homeless_flood due to disaster:
disaster_data_country_asia_homeless <- filter(disaster_data_country, (region %in% c(
                                                              "Asia")))
sorted = sort(disaster_data_country_asia_homeless$homeless_flood,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_asia_homeless[sorted[1:10],]
top10 <- data.frame(Entity=disaster_data_country_asia_homeless$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_asia_homeless,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$homeless_flood <- log (top10_data$homeless_flood)
p <- ggplot(top10_data, aes(x = reorder(Entity, +homeless_flood), y=homeless_flood, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

```{r message=FALSE}
# injured_all_disasters

continent_data$injured_all_disasters= 100*(continent_data$injured_all_disasters/sum(continent_data$injured_all_disasters))

ggplot(data=continent_data, aes(x=Entity, y=injured_all_disasters)) +
    geom_bar(colour="black", fill="#DD8888", width=.8, stat="identity",position=position_dodge()) +
    coord_flip() +
    ylab("percentage of total damages pct gdp all disaster") +
    labs(title = 'People death due to climate change disasters',
         subtitle = "Disasters: drought, temperature, flood, fog, wildfire, glacial lake",
         caption = "Number of people is calculated in perentage",
       ) + 
    labs(x = "") +
    theme_classic()
```

```{r message=FALSE}
# Checking the top 5 countries having injured_all_disasters due to disaster:
disaster_data_country_asia_injured <- filter(disaster_data_country, (region %in% c(
                                                              "Asia")))
sorted = sort(disaster_data_country_asia_injured$injured_all_disasters,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_asia_injured[sorted[1:10],]
top10 <- data.frame(Entity=disaster_data_country_asia_injured$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_asia_injured,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$injured_all_disasters <- log (top10_data$injured_all_disasters)
p <- ggplot(top10_data, aes(x = reorder(Entity, +injured_all_disasters), y=injured_all_disasters, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

```{r message=FALSE}
# Checking the top 5 countries having injured_temperature due to disaster:
disaster_data_country_asia_injured <- filter(disaster_data_country, (region %in% c(
                                                              "Asia")))
sorted = sort(disaster_data_country_asia_injured$injured_temperature,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_asia_injured[sorted[1:7],]
top10 <- data.frame(Entity=disaster_data_country_asia_injured$Entity[sorted[1:7]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_asia_injured,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$injured_temperature <- log (top10_data$injured_temperature)
p <- ggplot(top10_data, aes(x = reorder(Entity, +injured_temperature), y=injured_temperature, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

```{r message=FALSE}
# Checking the top 5 countries having injured_flood due to disaster:
disaster_data_country_asia_injured <- filter(disaster_data_country, (region %in% c(
                                                              "Asia")))
sorted = sort(disaster_data_country_asia_injured$injured_flood,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_asia_injured[sorted[1:10],]
top10 <- data.frame(Entity=disaster_data_country_asia_injured$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_asia_injured,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$injured_flood <- log (top10_data$injured_flood)
p <- ggplot(top10_data, aes(x = reorder(Entity, +injured_flood), y=injured_flood, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

#### Natural disaster - total_damages_pct_gdp_all_disasters

```{r message=FALSE}
# total_damages_pct_gdp_all_disasters

continent_data$total_damages_pct_gdp_all_disasters= 100*(continent_data$total_damages_pct_gdp_all_disasters/sum(continent_data$total_damages_pct_gdp_all_disasters))

ggplot(data=continent_data, aes(x=Entity, y=total_damages_pct_gdp_all_disasters)) +
    geom_bar(colour="black", fill="#DD8888", width=.8, stat="identity",position=position_dodge()) +
    coord_flip() +
    ylab("percentage of total damages pct gdp all disaster") +
    labs(title = 'People death due to climate change disasters',
         subtitle = "Disasters: drought, temperature, flood, fog, wildfire, glacial lake",
         caption = "Number of people is calculated in perentage",
       ) + 
    labs(x = "") +
    theme_classic()
```
```{r message=FALSE}
# Checking the top 5 countries having total_damages_pct_gdp_all_disasters due to disaster:
disaster_data_country_gdp <- filter(disaster_data_country, (region %in% c(
                                                              "Asia","Americas")))
sorted = sort(disaster_data_country_gdp$total_damages_pct_gdp_all_disasters,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_gdp[sorted[1:10],]
top10 <- data.frame(Entity=disaster_data_country_gdp$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_gdp,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$total_damages_pct_gdp_all_disasters <- log (top10_data$total_damages_pct_gdp_all_disasters)
p <- ggplot(top10_data, aes(x = reorder(Entity, +total_damages_pct_gdp_all_disasters), y=total_damages_pct_gdp_all_disasters, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

```{r message=FALSE}
# Checking the top 5 countries having total_damages_pct_gdp_temperature due to disaster:
disaster_data_country_gdp <- filter(disaster_data_country, (region %in% c(
                                                              "Asia","Americas")))
sorted = sort(disaster_data_country_gdp$total_damages_pct_gdp_temperature,decreasing = TRUE,index.return=TRUE)$ix

#Subseting Top20 countries by April 25th
top10 <- disaster_data_country_gdp[sorted[1:10],]
top10 <- data.frame(Entity=disaster_data_country_gdp$Entity[sorted[1:10]]) # construct a dataframe based on the top 5 countries
top10$Entity <- as.character(top10$Entity) # make the country names as character
#To plot:
top10_data <- dplyr::inner_join(disaster_data_country_gdp,top10,by="Entity") #join two tables together 
#length(unique(top5_data$Entity)) # Make sure the unique length is 5

#Barplot
top10_data$total_damages_pct_gdp_temperature <- log (top10_data$total_damages_pct_gdp_temperature)
p <- ggplot(top10_data, aes(x = reorder(Entity, +total_damages_pct_gdp_temperature), y=total_damages_pct_gdp_temperature, fill=sub.region)) + 
  geom_bar(stat = "identity") + 
  xlab(" ") +
  ylab("Number of people affected") +
  labs(title = 'Country affected by temperature',
       subtitle = "Number of people affected calculated in million"
       ) + 
  theme_classic() +
  coord_flip()
p
```

### Country analysis - affected_flood
## remove this
```{r message=FALSE}
# Affected all disaster
disaster_data_country <- filter(disaster_data, !(Entity %in% c("World",
                                                              "Upper middle income", 
                                                              "Lower middle income",
                                                              "Low income",
                                                              "High income",
                                                              "Asia", 
                                                              "Africa", 
                                                              "North America", 
                                                              "South America", 
                                                              "Antarctica",
                                                              "Europe", 
                                                              "Australia"))) %>% 
                          group_by(Entity) %>%
                          filter(Year == max(Year)) %>% # Take the most recent date per country
                          group_by() %>% #removing groupby
                          drop_na() 

#Joining disaster data with continent data:
colnames(continent_data_new)[1] <- "Entity"
disaster_data_country <- left_join(disaster_data_country, continent_data_new, by = c('Entity'))
disaster_data_country <- disaster_data_country %>% 
                        #filter(disaster_data_country, (region %in% c("Asia", "Americas","Africa"))) %>% 
                        drop_na() 
head(disaster_data_country,2)
```
<p align='justify'>
Observation:
</p>


<p align='justify'>
Observation:
</p>

### Children climate Risk and Environment analysis

```{r message=FALSE}
##Pre-processing
#Selecting only required columns from CC_ERI data for further analysis and visualization
cceri_data <- cceri_data %>% 
              select(REF_AREA,Geographic.area,Indicator,Value) %>%
              drop_na()

cceri_data <- cceri_data[!apply(is.na(cceri_data) | cceri_data == "", 1, any),]

cc_eri_data_new <- cceri_data %>%
                  pivot_wider(names_from = "Indicator",
                              values_from = "Value"
                              ) %>% 
                  drop_na() 

#Checking the number of rows and columns
#dim(cc_eri_data_new)

#Removing space in the column names of the dataset
names(cc_eri_data_new) <- sub(" ", "_", names(cc_eri_data_new))

#summary (cc_eri_data_new)
```

<p align='justify'>
Observation:
</p>

```{r message=FALSE}
##Pre-processing
#Selecting only required columns from CC_ERI data for further analysis and visualization
cceri_data <- cceri_data %>% 
              select(REF_AREA,Geographic.area,Indicator,Value) %>%
              drop_na()

cceri_data <- cceri_data[!apply(is.na(cceri_data) | cceri_data == "", 1, any),]

cc_eri_data_new <- cceri_data %>%
                  pivot_wider(names_from = "Indicator",
                              values_from = "Value"
                              ) %>% 
                  drop_na() 

#Checking the number of rows and columns
#dim(cc_eri_data_new)

#Removing space in the column names of the dataset
names(cc_eri_data_new) <- sub(" ", "_", names(cc_eri_data_new))

#summary (cc_eri_data_new)
```

```{r message=FALSE}
#Renaming the variables:
colnames(cc_eri_data_new)[1] <- "ISO_Code"
colnames(cc_eri_data_new)[4] <- "CCRI"
colnames(cc_eri_data_new)[6] <- "Child_health_nutrition"
colnames(cc_eri_data_new)[9] <- "Climate_environmental_shocks"
colnames(cc_eri_data_new)[21] <- "Soil_water_pollution"
colnames(cc_eri_data_new)[22] <- " Poverty_Inequality"
colnames(cc_eri_data_new)[23] <- "Social_protection_conomic_empowerment"
colnames(cc_eri_data_new)[25] <- "Vector_borne_diseases"
```

<p align='justify'>
Observation:
</p>

### Children Climate Risk Index (CCRI) - Worldwide

```{r message=FALSE}
cc_eri_data_new$CCRI <- as.numeric(as.character(cc_eri_data_new$CCRI))

#World map of country with CCRI:
l <- list(color = toRGB("black"), width = 0.5) # light black boundaries
# specify map projection/options
g <- list(
  showframe = FALSE,
  showcoastlines = FALSE,
  projection = list(type = 'robinson')
)
fig <- plot_geo(cc_eri_data_new)
fig <- fig %>% add_trace(
  z = ~CCRI, color = ~CCRI, colors = 'Reds',
  text = ~Geographic.area, locations = ~ISO_Code, marker = list(line = l)
)
fig <- fig %>% colorbar(title = 'CCRI', tickprefix = '')
fig <- fig %>% layout(
  title = 'Children Climate Risk Index (CCRI) - Worldwide',
  geo = g
)
fig
```

<p align='justify'>
Observation:
</p>

### Children health- Worldwide

```{r message=FALSE}

cc_eri_data_new$Child_health <- as.numeric(as.character(cc_eri_data_new$Child_health))
#cc_eri_data_new <- cc_eri_data_new %>% drop_na() #removing na values in the dataset
#World map of country with heatwaves:
l <- list(color = toRGB("black"), width = 0.5) # light black boundaries
# specify map projection/options
g <- list(
  showframe = FALSE,
  showcoastlines = FALSE,
  projection = list(type = 'Mercator')
)
fig <- plot_geo(cc_eri_data_new)
fig <- fig %>% add_trace(
  z = ~Child_health, color = ~Child_health, colors = 'Purples',
  text = ~Geographic.area, locations = ~ISO_Code, marker = list(line = l)
)
fig <- fig %>% colorbar(title = 'Child Health', tickprefix = '')
fig <- fig %>% layout(
  title = 'Child Health - Worldwide',
  geo = g
)
fig
```

<p align='justify'>
Observation:
</p>

```{r message=FALSE}

cc_eri_data_new$Child_vulnerability <- as.numeric(as.character(cc_eri_data_new$Child_vulnerability))
cc_eri_data_new <- cc_eri_data_new %>% drop_na() #removing na values in the dataset
#World map of country with heatwaves:
l <- list(color = toRGB("black"), width = 0.5) # light black boundaries
# specify map projection/options
g <- list(
  showframe = FALSE,
  showcoastlines = FALSE,
  projection = list(type = 'Mercator')
)
fig <- plot_geo(cc_eri_data_new)
fig <- fig %>% add_trace(
  z = ~Child_vulnerability, color = ~Child_vulnerability, colors = 'Blues',
  text = ~Geographic.area, locations = ~ISO_Code, marker = list(line = l)
)
fig <- fig %>% colorbar(title = 'Child Vulnerability', tickprefix = '')
fig <- fig %>% layout(
  title = 'Child Vulnerability - Worldwide',
  geo = g
)
fig
```

```{r message=FALSE}
#Visual 5: Heatwave exposure each year 
cc_eri_data_new$Child_health_nutrition <- as.numeric(as.character(cc_eri_data_new$Child_health_nutrition))
cc_eri_data_new <- cc_eri_data_new %>% drop_na() #removing na values in the dataset
#World map of country with heatwaves:
l <- list(color = toRGB("black"), width = 0.5) # light black boundaries
# specify map projection/options
g <- list(
  showframe = FALSE,
  showcoastlines = FALSE,
  projection = list(type = 'Mercator')
)
fig <- plot_geo(cc_eri_data_new)
fig <- fig %>% add_trace(
  z = ~Child_health_nutrition, color = ~Child_health_nutrition, colors = 'viridis',
  text = ~Geographic.area, locations = ~ISO_Code, marker = list(line = l)
)
fig <- fig %>% colorbar(title = 'Child health nutrition', tickprefix = '')
fig <- fig %>% layout(
  title = 'Child health nutrition - Worldwide',
  geo = g
)
fig
```

#### Correlation map
```{r message=FALSE}
# Correlation map
cc_eri_data_new$Child_nutrition <- as.numeric(as.numeric(cc_eri_data_new$Child_nutrition))
cc_eri_data_new$Climate_environmental_shocks <- as.numeric(as.numeric(cc_eri_data_new$Climate_environmental_shocks))
cc_eri_data_new$Education <- as.numeric(as.numeric(cc_eri_data_new$Education))
cc_eri_data_new$Coastal_floods <- as.numeric(as.numeric(cc_eri_data_new$Coastal_floods))
cc_eri_data_new$Heatwaves <- as.numeric(as.numeric(cc_eri_data_new$Heatwaves))
cc_eri_data_new$Soil_water_pollution <- as.numeric(as.numeric(cc_eri_data_new$Soil_water_pollution))
cc_eri_data_new$Vector_borne_diseases <- as.numeric(as.numeric(cc_eri_data_new$Vector_borne_diseases))
cc_eri_data_new$Water_scarcity <- as.numeric(as.numeric(cc_eri_data_new$Water_scarcity))
cc_eri_data_new$Aedes <- as.numeric(as.numeric(cc_eri_data_new$Aedes))
cc_eri_data_new$CCRI <- as.numeric(as.numeric(cc_eri_data_new$CCRI))
cc_eri_data_new$Communication_assets <- as.numeric(as.numeric(cc_eri_data_new$Communication_assets))
cc_eri_data_new$Dengue <- as.numeric(as.numeric(cc_eri_data_new$Dengue))
cc_eri_data_new$Riverine_floods <- as.numeric(as.numeric(cc_eri_data_new$Riverine_floods))
cc_eri_data_new$Malaria <- as.numeric(as.numeric(cc_eri_data_new$Malaria))
cc_eri_data_new$Maternal_health <- as.numeric(as.numeric(cc_eri_data_new$Maternal_health))
cc_eri_data_new$Air_pollution <- as.numeric(as.numeric(cc_eri_data_new$Air_pollution))

cc_eri_corr <- cc_eri_data_new[c(3:7)] %>% drop_na() 
cc_eri_corr <- cc_eri_corr[-c(1,2)]

#library(corrplot)

#corrplot.mixed(cc_eri_corr, lower = "number", upper = "square", number.cex = 0.7,
 #        order = "hclust")

```

<p align='justify'>
Observation:
</p>

```{r fig.height = 7, fig.height = 8, message=FALSE}
#Visualization 7,8,9, 19: 
#Selecting top 10 countries having high CCRI
cceri_data_facet <- filter(cceri_data, 
                           REF_AREA %in% c("CAF","COD","BGD","CIV","PHL","UGA","IDN","THA","MYS","SLV"))

cceri_data_facet <- filter(cceri_data_facet, 
                           Indicator %in% c(#"Communication assets",
                                            "Education",
                                            "Coastal floods",
                                            "Maternal health",
                                            "Air pollution",
                                            "Pesticide pollution",
                                            "Soil and water pollution",
                                            "Poverty and Inequality",
                                            "Vector borne diseases","Water scarcity"))

p1 <- ggplot( cceri_data_facet, aes( x = Geographic.area, y = Value ) ) + 
  geom_bar( stat = "identity" ) + 
  facet_wrap( ~ Indicator) + 
  xlab("Country code") + 
  ylab("Indicator")  +
  geom_text( aes( label = paste0( Value, "%" ), y = Value ),
             vjust = 1.4, size = 2, color = "white" )+
  #theme_minimal() +
  #scale_x_discrete(limits = c(1,10)) +
  coord_flip()

p1 + scale_x_discrete(breaks=c("1","2","3","4","5","6","7","8","9","10"),
                        labels=c("1","2","3","4","5","6","7","8","9","10"))

#p1 + theme_bw() + 
  #theme( axis.text.x = element_text( angle = 90,  hjust = 1 ) )


```

<p align='justify'>
Observation:
</p>

```{r message=FALSE}

```

<p align='justify'>
Observation:
</p>

## Additional visualizations and further analyses with the data
1. Trend analysis of each country emission level
2. Children Climate Risk Index

## Conclusion
<p align='justify'>
The world is entering unprecedented era as climate change drives unprecedented global environmental, societal, and economic disruption. Exploring and analyzing the greenhouse gas emitters due to industrial revolution, while taking proper measures we can protect and support the society, especially the children.
</p>

## Data Source {.appendix}
<p align='justify'>
The data used for this study is extracted from *Our World in Data (OWID)*.
The data produced by is collected by UN, World Resources Institute , NASA and made available by Our World in Data. 
</p>
1. Emission levels with temperature <br>
	  Link : *< https://data.giss.nasa.gov/gistemp/  https://data.giss.nasa.gov/gistemp/tabledata_v4/T_AIRS/GLB.Ts+dSST.csv>* <br>
	  Latest Year : 2021 <br>
	  Observations :  <br>
	  Variables:  40 <br>
	  Last update: September 6, 2022<br>
	  Meta data:
	    - GISS Surface Temperature Analysis (GISTEMP v4)
	    - estimate of global surface temperature change
	    - Graphs and tables are updated around the middle of every month using current data files from NOAA GHCN v4(meteorological stations) and ERSST v5 (ocean areas)
	    - These updated files incorporate reports for the previous month and also late reports and corrections for earlier months.
      - Comparison with one-dimensional global climate models. 
	  
2. Natural disaster <br>
	  Link : *<https://raw.githubusercontent.com/owid/owid-datasets/master/datasets/Natural%20disasters%20(EMDAT%20–%20decadal)/Natural%20disasters%20(EMDAT%20–%20decadal).csv>* <br>
	  Latest Year : 2010 <br>
	  Observations: 1604 <br>
	  Variables: 164 <br>
	  Last update: 2021 <br>
	  Meta data:
	    - This data has been aggregated by Our World in Data by country and year based on the raw database of disasters published by EM-DAT, CRED / UCLouvain, Brussels, Belgium – www.emdat.be
	    - EM-DAT publishes comprehensive, global data on each individual disaster event – estimating the number of deaths; people affected; and economic damages, from UN reports; government records; expert opinion; and additional sources.
	    - Our World in Data have calculated annual aggregates, and decadal averages, for each country based on this raw event-by-event dataset.
Decadal figures are measured as the annual average over the subsequent ten-year period. This means figures for ‘1900’ represent the average from 1900 to 1909; ‘1910’ is the average from 1910 to 1919 etc.

3. Children’s Climate and Environment Risk Index (CCRI) <br>
    Metadata:
	  Link : *<https://github.com/owid/owid-datasets/tree/master/datasets/Global%20temperature%20anomaly%20-%20Met%20Office%20(HadCRUT4)>* <br>
	  Observations: 4075 <br>
	  Variables: 4 <br>
	  Last update: 2022 <br>
	  CCRI depends on two components:
    - Pillar 1 measures exposure to climate and environmental shocks and stresses. 
    - Pillar 2 captures child vulnerability. 
The data is updated regularly and most metrics are published on an annual basis.

## References {.unnumbered .appendix}

::: {}
James H. Stock, *Climate Change, Climate Policy, and Economic Growth, July 1, 2019* <https://heep.hks.harvard.edu/files/heep/files/dp_85_stock.pdf>

Luís Roberto Barroso, *TECHNOLOGICAL REVOLUTION, DEMOCRATIC RECESSION AND CLIMATE CHANGE: THE LIMITS OF LAW IN A CHANGING WORLD,2019*, https://carrcenter.hks.harvard.edu/files/cchr/files/ccdp_2019_009_technology_democracy.pdf
:::
